{% extends 'admin/base.html.twig' %}

{% block title %}Jersey{% endblock %}

{% block body %}
	<h1>Jersey</h1>
	<a btn href="{{ path('admin.jerseys.list') }}">back to list</a>
	<a btn primary href="{{ path('admin.jerseys.create') }}">Create new</a>
	<grid>
		<div col="1/2">

			<card>
				<grid>
					<div col="1/3">
						<img src="{{ asset('/storage/jerseys/' ~ jersey.picture) }}" alt="{{ jersey.computedName }}"/>
					</div>
					<div col="2/3">
						<table>
							<tbody>
							<tr>
								<td>Id</td>
								<td>{{ jersey.id }}</td>
							</tr>
							<tr>
								<td>Computed name</td>
								<td>{{ jersey.computedName }}</td>
							</tr>
							<tr>
								<td>Year</td>
								<td>{{ jersey.year.value }}</td>
							</tr>
							<tr>
								<td>Slug</td>
								<td>{{ jersey.slug }}</td>
							</tr>
							<tr>
								<td>Type</td>
								<td>{{ jersey.type.value }}</td>
							</tr>
							<tr>
								<td>UpdatedAt</td>
								<td>{{ jersey.updatedAt|date('Y-m-d') }}</td>
							</tr>
							</tbody>
						</table>
					</div>
				</grid>

				<hr>

				<div class="actions">
					<a btn href="{{ path('admin.jerseys.edit', {'slug': jersey.slug}) }}">edit</a>
					{% if jersey.offers.count == 0 %}
						<form method="post" action="{{ path('admin.jerseys.delete', {'slug': jersey.slug}) }}"
									onsubmit="return confirm('Are you sure you want to delete this item?');">
							<input type="hidden" name="_token" value="{{ csrf_token('delete' ~ jersey.id) }}">
							<button type="button">Delete</button>
						</form>
					{% endif %}
				</div>
			</card>
		</div>
		<div col="1/2">
			<card>
				<h3>Add an offer</h3>
				{{ form(offerForm) }}
			</card>
		</div>
		<div col="1/1">
			<card class="offers">
				<h2>Offers</h2>
				<table>
					<thead>
					<tr>
						<th>Seller</th>
						<th>Type</th>
						<th>Price</th>
						<th>Actions</th>
					</tr>
					</thead>
					<tbody>
					{% for offer in jersey.offers %}
						<tr>
							<td>
								<div class="offer">
									<img src="{{ offer.seller.logo }}" alt="{{ offer.seller.name }}">
									<span class="name">{{ offer.seller.name }}</span>
								</div>
							</td>
							<td><span>{{ offer.format |trans }}</span></td>
							<td><span>{{ offer.price|format_currency('USD') }}</span></td>
							<td>
								<a href="{{ path('admin.offers.edit', {id: offer.id}) }}">Edit</a>
								<a href="{{ offer.url }}" target="_blank" rel="noopener noreferrer">View</a>
							</td>
						</tr>
					{% endfor %}
					</tbody>
				</table>
			</card>
		</div>

	</grid>
{% endblock %}
